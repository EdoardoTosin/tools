{%- comment -%}
*
* MIT License
* Copyright (c) 2025 Edoardo Tosin
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* File: Homepage.html
* Author Edoardo Tosin
*
* This file contains the markup for displaying and copying script execution
* commands for Linux, Windows, and Python on the homepage with search and filter functionality.
*
{%- endcomment -%}

{%- assign postfix_python = "python" -%}

{%- assign prefix_linux = "curl -sSL" -%}
{%- assign postfix_linux = "sh" -%}

{%- assign prefix_win = "irm" -%}
{%- assign postfix_win = "iex" -%}

{%- assign ordered_types = "linux,windows,python" | split: "," -%}

{%- assign github_raw_base = "https://raw.githubusercontent.com/EdoardoTosin/tools/refs/heads/main/script/" -%}

{%- if site.data.script and site.data.script.size > 0 -%}
  {%- assign types = site.data.script | group_by: "type" | sort: ordered_types -%}
{%- else -%}
  <p>No scripts available. Please try again later.</p>
{%- endif -%}

<!-- Search and Filter Section -->
<div class="mb-5">
  <div class="field is-grouped is-grouped-multiline mb-4">
    <div class="control is-expanded">
      <div class="field has-addons">
        <div class="control has-icons-left is-expanded">
          <input class="input is-medium" type="text" id="script-search" placeholder="Search scripts..." autocomplete="off" />
          <span class="icon is-left has-text-grey">
            {% include Icon.html name="search" size="20" %}
          </span>
        </div>
      </div>
    </div>
    
    <!-- Filter Controls -->
    <div class="filter-controls">
      <select id="type-filter" class="filter-select">
        <option value="all">All Types</option>
        <option value="linux">Linux</option>
        <option value="windows">Windows</option>
        <option value="python">Python</option>
      </select>
      
      <button id="sort-toggle" class="sort-button" title="Toggle sort order">
        {% include Icon.html name="order-up" size="16" %} A-Z
      </button>
    </div>
  </div>
  
  <div id="script-count" class="meta-title small script-count-container">
    <span class="count-content has-text-primary">
      <span id="results-count">{{ site.data.script.size }}</span> scripts found
    </span>
  </div>
</div>

<!-- Scripts Container -->
<div id="scripts-container">
  {%- for ordered_type in ordered_types -%}
    {%- assign filtered_type = types | where: "name", ordered_type -%}
    {%- if filtered_type[0].items.size > 0 -%}
      <div class="section script-type-section" data-type="{{ ordered_type }}">
        <h2>{{ ordered_type | capitalize }} Scripts</h2>
        <div class="related-wrapper">
          {%- for file in filtered_type[0].items -%}
            {%- assign github_script_url = github_raw_base | append: file.name -%}
            <div class="related-group script-card" data-name="{{ file.name | downcase }}" data-type="{{ ordered_type }}" data-script-url="{{ github_script_url }}" onclick="redirectToGitHub(this)" style="cursor: pointer;" title="Click to view raw script on GitHub">
              <div class="meta-head">
                <h6 class="script-name">{{ file.name }}</h6>
                <span class="meta-title script-type-badge {{ ordered_type }}">{{ ordered_type }}</span>
              </div>
              
              <div class="script-actions margin-top-10" onclick="event.stopPropagation();">
                {%- if ordered_type == "python" -%}
                  <div class="python-dropdown">
                    <button class="action-button primary tools" onclick="toggleDropdown(this)" aria-label="Select platform for Python script">
                      <span class="button-icon">
                        {% include Icon.html name="clipboard" size="16" %}
                      </span> Copy Command
                      <span class="dropdown-arrow">
                        {% include Icon.html name="chevron-down" size="12" %}
                      </span>
                    </button>
                    <div class="dropdown-content">
                      <button class="dropdown-item tools" onclick="copyCommand('{{ github_script_url }}', '{{ prefix_linux }}', '{{ postfix_python }}')" title="Click to copy command: &quot;{{ prefix_linux }} '{{ github_script_url }}' | {{ postfix_python }}&quot;" aria-label="Copy Linux command for Python script">
                        <span class="platform-icon">
                          {% include Icon.html name="linux" size="16" %}
                        </span> Copy for Linux
                      </button>
                      <button class="dropdown-item tools" onclick="copyCommand('{{ github_script_url }}', '{{ prefix_win }}', '{{ postfix_python }}')" title="Click to copy command: &quot;{{ prefix_win }} '{{ github_script_url }}' | {{ postfix_python }}&quot;" aria-label="Copy Windows command for Python script">
                        <span class="platform-icon">
                          {% include Icon.html name="windows" size="16" %}
                        </span> Copy for Windows
                      </button>
                    </div>
                  </div>
                {%- elsif ordered_type == "linux" -%}
                  <button class="action-button primary tools" onclick="copyCommand('{{ github_script_url }}', '{{ prefix_linux }}', '{{ postfix_linux }}')" title="Click to copy command: &quot;{{ prefix_linux }} '{{ github_script_url }}' | {{ postfix_linux }}&quot;" aria-label="Copy Linux command">
                    <span class="button-icon">
                      {% include Icon.html name="clipboard" size="16" %}
                    </span> Copy Command
                  </button>
                {%- elsif ordered_type == "windows" -%}
                  <button class="action-button primary tools" onclick="copyCommand('{{ github_script_url }}', '{{ prefix_win }}', '{{ postfix_win }}')" title="Click to copy command: &quot;{{ prefix_win }} '{{ github_script_url }}' | {{ postfix_win }}&quot;" aria-label="Copy Windows command">
                    <span class="button-icon">
                      {% include Icon.html name="clipboard" size="16" %}
                    </span> Copy Command
                  </button>
                {%- endif -%}
                
                <button class="action-button secondary tools" onclick="downloadScript('{{ github_script_url }}', '{{ file.name }}')" title="Download script file">
                  <span class="button-icon">
                    {% include Icon.html name="download" size="16" %}
                  </span> Download Script
                </button>
              </div>
            </div>
          {%- endfor -%}
        </div>
      </div>
    {%- endif -%}
  {%- endfor -%}
</div>

<!-- No Results Message -->
<div id="no-results" class="centre-title hide">
  <div class="section">
    <span class="no-results-icon large">
      {% include Icon.html name="search" size="48" %}
    </span>
    <h3>No scripts found</h3>
    <p class="excerpt">Try adjusting your search terms or filters</p>
  </div>
</div>

<div id="copy-notification" role="alert" aria-live="assertive" tabindex="-1">Command copied to clipboard!</div>

<link href="{{ site.baseurl }}/assets/css/style.css" rel="stylesheet" media="all" class="default" />
<script src="{{ site.baseurl }}/assets/js/scripts.js" {{ "/assets/js/scripts.js" | sri_attrs }}></script>
