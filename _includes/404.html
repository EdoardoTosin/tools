{%- comment -%}
*
* MIT License
* Copyright (c) 2025 Edoardo Tosin
*
* Permission is hereby granted, free of charge, to any person obtaining a copy
* of this software and associated documentation files (the "Software"), to deal
* in the Software without restriction, including without limitation the rights
* to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
* copies of the Software, and to permit persons to whom the Software is
* furnished to do so, subject to the following conditions:
*
* The above copyright notice and this permission notice shall be included in all
* copies or substantial portions of the Software.
*
* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
* IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
* FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
* AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
* LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
* OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
* SOFTWARE.
*
* File: Tags.html
* Edoardo Tosin
*
* This file contains the markup for the 404 page content.
*
{%- endcomment -%}

<p class="disable-select has-text-centered">
  <img id="error-404" src="{{ site.domain_url }}/assets/img/404.gif" alt="Error 404" aria-label="Page not found error image">
</p>

<div class="has-text-centered">
  <h2 class="title is-3">Oops! Page Not Found</h2>
  <p class="subtitle is-5">The page you were looking for doesn't exist or may have been moved.</p>
  <p class="subtitle is-6 margin-top-20">
    Don't worry - here's a random page you might enjoy instead:
  </p>
</div>

<div id="random-suggestion" class="section">
  <div class="container">
    <div id="loading" class="has-text-centered">
      <p class="subtitle">Loading a random page for you...</p>
    </div>
    <div id="suggestion" style="display: none;">
      <div class="notelist-feed">
        <a id="random-link" style="text-decoration: none;" href="#" aria-label="Random page suggestion">
          <h6 id="random-title"></h6>
          <p id="random-description" class="excerpt"></p>
        </a>
      </div>
      <div class="buttons is-centered margin-top-20">
        <button id="random-button" class="button is-warning is-medium has-text-black" aria-label="Try another random page">
          <span>Try Another</span>
        </button>
        <a href="{{ site.domain_url }}/" class="button is-link is-medium has-text-white no-external-link-icon" style="text-decoration: none;" aria-label="Go to homepage">
          <span>Go to Homepage</span>
        </a>
      </div>
    </div>
  </div>
</div>

<script>
(function() {
  var searchData = null;

  function loadSearchData() {
    fetch('{{ site.domain_url }}/SearchData.json')
      .then(function(response) { return response.json(); })
      .then(function(data) {
        searchData = data;
        getRandomPage();
      })
      .catch(function() {
        document.getElementById('loading').innerHTML = '<p class="subtitle">Sorry, unable to load suggestions.</p>';
      });
  }

  function getRandomPage() {
    if (!searchData) return;

    var keys = Object.keys(searchData);
    if (keys.length === 0) return;

    var randomPage = searchData[keys[Math.floor(Math.random() * keys.length)]];

    document.getElementById('random-title').textContent = randomPage.title || 'Untitled';
    document.getElementById('random-description').textContent =
      randomPage.description ||
      (randomPage.content ? randomPage.content.substring(0, 150) + '...' : 'No description available');
    document.getElementById('random-link').href = randomPage.url || '#';

    document.getElementById('loading').style.display = 'none';
    document.getElementById('suggestion').style.display = 'block';
  }

  document.addEventListener('DOMContentLoaded', function() {
    loadSearchData();
    document.getElementById('random-button').addEventListener('click', function() {
      getRandomPage();
      this.blur();
    });
  });
})();
</script>
